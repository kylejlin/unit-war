!function(t){var e={};function i(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="./",i(i.s=0)}([function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}function u(t,e,i){for(var r=0,a=0,n=i.hands,u=i.ante,o=0;o<n;o++)if(Math.random()>.5){var h=s(t,e,u);r+=h,a-=h}else{var d=s(e,t,u);a+=d,r-=d}return(r-a)/2}function s(t,e,i){var r=Math.random(),a=Math.random(),n=t.lead(r,a),u=Math.max(i,n[0]),s=Math.max(u,n[1]),o=Math.random(),h=Math.random(),d=Math.max(i,e.follow(o,u,h));return d<u?i:d>s?-u:r>o?d:r<o?-d:0}function o(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,r=0;0===i;)i=Math.random();for(;0===r;)r=Math.random();var a=Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*r);return e*a+t}i.r(e);var h=function(){function t(e,i){r(this,t),this.leaderNetwork=e,this.followerNetwork=i,this.agentType=void 0,this.inputs=void 0,this.agentType=L.Artichoke,this.inputs=new Float64Array(3)}return n(t,[{key:"lead",value:function(t,e){var i=this.inputs;return i[0]=t,i[1]=e,this.leaderNetwork.evaluate(i)}},{key:"follow",value:function(t,e,i){var r=this.inputs;return r[0]=t,r[1]=e,r[2]=i,this.followerNetwork.evaluate(r)[0]}},{key:"train",value:function(t,e){this.leaderNetwork.train(this,t,e),this.followerNetwork.train(this,t,e)}},{key:"toArrayBuffer",value:function(){var t=new Float64Array(this.leaderNetwork.toArrayBuffer()),e=new Float64Array(this.followerNetwork.toArrayBuffer()),i=new Float64Array(3+t.length+e.length);return i[0]=this.agentType,i[1]=t.length,i[2]=e.length,i.set(t,3),i.set(e,3+t.length),i.buffer}}],[{key:"fromCreationOptions",value:function(e){return t.fromHiddenLayerSize(e.hiddenLayerSize)}},{key:"fromHiddenLayerSize",value:function(e){return new t(d.fromLayerSizes(2,e,2),d.fromLayerSizes(3,e,1))}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[1],a=i[2];return new t(d.fromArrayBuffer(i.slice(3,3+r).buffer),d.fromArrayBuffer(i.slice(3+r,3+r+a).buffer))}}]),t}(),d=function(){function t(e,i,a){r(this,t),this.buffer=void 0,this.inputSize=void 0,this.hiddenSize=void 0,this.outputSize=void 0,this.hiddenWeights=void 0,this.hiddenBiases=void 0,this.hiddenActivations=void 0,this.outputWeights=void 0,this.outputBiases=void 0,this.outputActivations=void 0,this.updatedHiddenWeights=void 0,this.updatedHiddenBiases=void 0,this.updatedOutputWeights=void 0,this.updatedOutputBiases=void 0;var n=i*e,u=i,s=i,o=a*i,h=a,d=a,l=new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o+h));this.buffer=l,this.inputSize=e,this.hiddenSize=i,this.outputSize=a,this.hiddenWeights=new Float64Array(l,0,n),this.hiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*n,u),this.hiddenActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u),s),this.outputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s),o),this.outputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o),h),this.outputActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h),d),this.updatedHiddenWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d),n),this.updatedHiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n),u),this.updatedOutputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u),o),this.updatedOutputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o),h),this.initializeWeights()}return n(t,null,[{key:"fromLayerSizes",value:function(e,i,r){return new t(e,i,r)}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[0],a=i[1],n=i[2],u=a*r,s=a,o=i.subarray(3,3+u),h=i.subarray(3+u,3+u+s),d=n*a,l=n,f=i.subarray(3+u+s,3+u+s+d),v=i.subarray(3+u+s+d,3+u+s+d+l),y=new t(r,a,n);return y.hiddenWeights.set(o),y.hiddenBiases.set(h),y.outputWeights.set(f),y.outputBiases.set(v),y}}]),n(t,[{key:"initializeWeights",value:function(){l(this.hiddenWeights,this.inputSize),l(this.outputWeights,this.hiddenSize)}},{key:"evaluate",value:function(t){for(var e,i=this.inputSize,r=this.hiddenSize,a=this.outputSize,n=this.hiddenWeights,u=this.hiddenBiases,s=this.hiddenActivations,o=this.outputWeights,h=this.outputBiases,d=this.outputActivations,l=0;l<r;l++){for(var v=0,y=0;y<i;y++)v+=n[l*i+y]*t[y];s[l]=(e=v+u[l],Math.max(0,e))}for(var p=0;p<a;p++){for(var g=0,c=0;c<r;c++)g+=o[p*r+c]*s[c];d[p]=f(g+h[p])}return d}},{key:"train",value:function(t,e,i){for(var r=i.evaluationOptions,a=u(t,e,r),n=this.hiddenWeights,s=this.updatedHiddenWeights,o=this.hiddenBiases,h=this.updatedHiddenBiases,d=this.outputWeights,l=this.updatedOutputWeights,f=this.outputBiases,v=this.updatedOutputBiases,y=i.derivativeStep,p=i.learningRate,g=n.length,c=0;c<g;c++){var A=n[c];n[c]+=y;var E=(u(t,e,r)-a)/y;s[c]=A+E*p,n[c]=A}for(var B=o.length,w=0;w<B;w++){var S=o[w];o[w]+=y;var k=(u(t,e,r)-a)/y;h[w]=S+k*p,o[w]=S}for(var F=d.length,T=0;T<F;T++){var W=d[T];d[T]+=y;var m=(u(t,e,r)-a)/y;l[T]=W+m*p,d[T]=W}for(var z=f.length,_=0;_<z;_++){var M=f[_];f[_]+=y;var b=(u(t,e,r)-a)/y;v[_]=M+b*p,f[_]=M}n.set(s),o.set(h),d.set(l),f.set(v)}},{key:"toArrayBuffer",value:function(){var t=this.inputSize,e=this.hiddenSize,i=this.outputSize,r=this.hiddenWeights,a=this.hiddenBiases,n=this.outputWeights,u=this.outputBiases,s=new Float64Array(3+r.length+a.length+n.length+u.length);return s[0]=t,s[1]=e,s[2]=i,s.set(r,3),s.set(a,3+r.length),s.set(n,3+r.length+a.length),s.set(u,3+r.length+a.length+n.length),s.buffer}}]),t}();function l(t,e){for(var i=0;i<t.length;i++)t[i]=o(0,1/Math.sqrt(e))}function f(t){return 1/(1+Math.exp(-t))}var v=function(){var t=new Uint32Array([2864434397]),e=new Uint16Array(t.buffer);if(43707===e[0]&&52445===e[1])return!0;if(43707===e[1]&&52445===e[0])return!1;throw new Error("Could not detect endianness.")}()?function(t,e){g[0]=t*y,e[0]=c[0]/p,e[1]=c[1]/p}:function(t,e){g[0]=t*y,e[0]=c[1]/p,e[1]=c[0]/p};var y=Math.pow(2,32),p=Math.pow(2,16),g=new Uint32Array(1),c=new Uint16Array(g.buffer);var A=function(){function t(){r(this,t),this.agentType=void 0,this.leadOutput=void 0,this.agentType=L.Broccoli,this.leadOutput=new Float64Array(2)}return n(t,null,[{key:"fromCreationOptions",value:function(e){return new t}},{key:"fromArrayBuffer",value:function(e){return new t}}]),n(t,[{key:"lead",value:function(t,e){var i=this.leadOutput;return v(e,i),i}},{key:"follow",value:function(t,e,i){return i}},{key:"train",value:function(){}},{key:"toArrayBuffer",value:function(){return new Float64Array([L.Broccoli]).buffer}}]),t}();var E=function(){function t(){r(this,t),this.agentType=void 0,this.leadOutput=void 0,this.agentType=L.Carrot,this.leadOutput=new Float64Array(2)}return n(t,null,[{key:"fromCreationOptions",value:function(e){return new t}},{key:"fromArrayBuffer",value:function(e){return new t}}]),n(t,[{key:"lead",value:function(t){var e=this.leadOutput;return e[0]=t,e[1]=t,e}},{key:"follow",value:function(t){return t}},{key:"train",value:function(){}},{key:"toArrayBuffer",value:function(){return new Float64Array([L.Carrot]).buffer}}]),t}();var B=function(){function t(e){r(this,t),this.agentType=void 0,this.leadOutput=void 0,this.agentType=L.Daikon,this.leadOutput=new Float64Array([e,e])}return n(t,[{key:"lead",value:function(){return this.leadOutput}},{key:"follow",value:function(){return this.leadOutput[0]}},{key:"train",value:function(){}},{key:"toArrayBuffer",value:function(){var t=this.leadOutput[0];return new Float64Array([L.Daikon,t]).buffer}}],[{key:"fromCreationOptions",value:function(e){return new t(e.bet)}},{key:"fromArrayBuffer",value:function(e){return new t(new Float64Array(e)[1])}}]),t}();var w=function(){function t(){r(this,t),this.agentType=void 0,this.leadOutput=void 0,this.agentType=L.Eggplant,this.leadOutput=new Float64Array(2)}return n(t,null,[{key:"fromCreationOptions",value:function(e){return new t}},{key:"fromArrayBuffer",value:function(e){return new t}}]),n(t,[{key:"lead",value:function(t){var e=this.leadOutput;return e[0]=t,e[1]=t>.5?1:0,e}},{key:"follow",value:function(t,e){return t>.5?Math.max(t,e):t}},{key:"train",value:function(){}},{key:"toArrayBuffer",value:function(){return new Float64Array([L.Eggplant]).buffer}}]),t}();var S=function(){function t(e,i){r(this,t),this.leaderNetwork=e,this.followerNetwork=i,this.agentType=void 0,this.inputs=void 0,this.agentType=L.Fig,this.inputs=new Float64Array(3)}return n(t,[{key:"lead",value:function(t,e){var i=this.inputs;return i[0]=t,i[1]=e,this.leaderNetwork.evaluate(i)}},{key:"follow",value:function(t,e,i){var r=this.inputs;return r[0]=t,r[1]=e,r[2]=i,this.followerNetwork.evaluate(r)[0]}},{key:"train",value:function(t,e){var i=this.leaderNetwork,r=this.followerNetwork;i.trainWithoutUpdating(this,t,e),r.trainWithoutUpdating(this,t,e),i.update(),r.update()}},{key:"toArrayBuffer",value:function(){var t=new Float64Array(this.leaderNetwork.toArrayBuffer()),e=new Float64Array(this.followerNetwork.toArrayBuffer()),i=new Float64Array(3+t.length+e.length);return i[0]=this.agentType,i[1]=t.length,i[2]=e.length,i.set(t,3),i.set(e,3+t.length),i.buffer}}],[{key:"fromCreationOptions",value:function(e){return t.fromHiddenLayerSize(e.hiddenLayerSize)}},{key:"fromHiddenLayerSize",value:function(e){return new t(k.fromLayerSizes(2,e,2),k.fromLayerSizes(3,e,1))}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[1],a=i[2];return new t(k.fromArrayBuffer(i.slice(3,3+r).buffer),k.fromArrayBuffer(i.slice(3+r,3+r+a).buffer))}}]),t}(),k=function(){function t(e,i,a){r(this,t),this.buffer=void 0,this.inputSize=void 0,this.hiddenSize=void 0,this.outputSize=void 0,this.hiddenWeights=void 0,this.hiddenBiases=void 0,this.hiddenActivations=void 0,this.outputWeights=void 0,this.outputBiases=void 0,this.outputActivations=void 0,this.updatedHiddenWeights=void 0,this.updatedHiddenBiases=void 0,this.updatedOutputWeights=void 0,this.updatedOutputBiases=void 0;var n=i*e,u=i,s=i,o=a*i,h=a,d=a,l=new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o+h));this.buffer=l,this.inputSize=e,this.hiddenSize=i,this.outputSize=a,this.hiddenWeights=new Float64Array(l,0,n),this.hiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*n,u),this.hiddenActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u),s),this.outputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s),o),this.outputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o),h),this.outputActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h),d),this.updatedHiddenWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d),n),this.updatedHiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n),u),this.updatedOutputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u),o),this.updatedOutputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o),h),this.initializeWeights()}return n(t,null,[{key:"fromLayerSizes",value:function(e,i,r){return new t(e,i,r)}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[0],a=i[1],n=i[2],u=a*r,s=a,o=i.subarray(3,3+u),h=i.subarray(3+u,3+u+s),d=n*a,l=n,f=i.subarray(3+u+s,3+u+s+d),v=i.subarray(3+u+s+d,3+u+s+d+l),y=new t(r,a,n);return y.hiddenWeights.set(o),y.hiddenBiases.set(h),y.outputWeights.set(f),y.outputBiases.set(v),y}}]),n(t,[{key:"initializeWeights",value:function(){F(this.hiddenWeights,this.inputSize),F(this.outputWeights,this.hiddenSize)}},{key:"evaluate",value:function(t){for(var e,i=this.inputSize,r=this.hiddenSize,a=this.outputSize,n=this.hiddenWeights,u=this.hiddenBiases,s=this.hiddenActivations,o=this.outputWeights,h=this.outputBiases,d=this.outputActivations,l=0;l<r;l++){for(var f=0,v=0;v<i;v++)f+=n[l*i+v]*t[v];s[l]=(e=f+u[l],Math.max(0,e))}for(var y=0;y<a;y++){for(var p=0,g=0;g<r;g++)p+=o[y*r+g]*s[g];d[y]=T(p+h[y])}return d}},{key:"trainWithoutUpdating",value:function(t,e,i){for(var r=i.evaluationOptions,a=u(t,e,r),n=this.hiddenWeights,s=this.updatedHiddenWeights,o=this.hiddenBiases,h=this.updatedHiddenBiases,d=this.outputWeights,l=this.updatedOutputWeights,f=this.outputBiases,v=this.updatedOutputBiases,y=i.derivativeStep,p=i.learningRate,g=n.length,c=0;c<g;c++){var A=n[c];n[c]+=y;var E=(u(t,e,r)-a)/y;s[c]=A+E*p,n[c]=A}for(var B=o.length,w=0;w<B;w++){var S=o[w];o[w]+=y;var k=(u(t,e,r)-a)/y;h[w]=S+k*p,o[w]=S}for(var F=d.length,T=0;T<F;T++){var W=d[T];d[T]+=y;var m=(u(t,e,r)-a)/y;l[T]=W+m*p,d[T]=W}for(var z=f.length,_=0;_<z;_++){var M=f[_];f[_]+=y;var b=(u(t,e,r)-a)/y;v[_]=M+b*p,f[_]=M}}},{key:"update",value:function(){var t=this.hiddenWeights,e=this.updatedHiddenWeights,i=this.hiddenBiases,r=this.updatedHiddenBiases,a=this.outputWeights,n=this.updatedOutputWeights,u=this.outputBiases,s=this.updatedOutputBiases;t.set(e),i.set(r),a.set(n),u.set(s)}},{key:"toArrayBuffer",value:function(){var t=this.inputSize,e=this.hiddenSize,i=this.outputSize,r=this.hiddenWeights,a=this.hiddenBiases,n=this.outputWeights,u=this.outputBiases,s=new Float64Array(3+r.length+a.length+n.length+u.length);return s[0]=t,s[1]=e,s[2]=i,s.set(r,3),s.set(a,3+r.length),s.set(n,3+r.length+a.length),s.set(u,3+r.length+a.length+n.length),s.buffer}}]),t}();function F(t,e){for(var i=0;i<t.length;i++)t[i]=o(0,1/Math.sqrt(e))}function T(t){return 1/(1+Math.exp(-t))}var W=function(){function t(e,i){r(this,t),this.leaderNetwork=e,this.followerNetwork=i,this.agentType=void 0,this.inputs=void 0,this.agentType=L.Grape,this.inputs=new Float64Array(3)}return n(t,[{key:"lead",value:function(t,e){var i=this.inputs;return i[0]=2*t-1,i[1]=2*e-1,this.leaderNetwork.evaluate(i)}},{key:"follow",value:function(t,e,i){var r=this.inputs;return r[0]=2*t-1,r[1]=2*e-1,r[2]=2*i-1,this.followerNetwork.evaluate(r)[0]}},{key:"train",value:function(t,e){var i=this.leaderNetwork,r=this.followerNetwork;i.trainWithoutUpdating(this,t,e),r.trainWithoutUpdating(this,t,e),i.update(),r.update()}},{key:"toArrayBuffer",value:function(){var t=new Float64Array(this.leaderNetwork.toArrayBuffer()),e=new Float64Array(this.followerNetwork.toArrayBuffer()),i=new Float64Array(3+t.length+e.length);return i[0]=this.agentType,i[1]=t.length,i[2]=e.length,i.set(t,3),i.set(e,3+t.length),i.buffer}}],[{key:"fromCreationOptions",value:function(e){return t.fromHiddenLayerSize(e.hiddenLayerSize)}},{key:"fromHiddenLayerSize",value:function(e){return new t(m.fromLayerSizes(2,e,2),m.fromLayerSizes(3,e,1))}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[1],a=i[2];return new t(m.fromArrayBuffer(i.slice(3,3+r).buffer),m.fromArrayBuffer(i.slice(3+r,3+r+a).buffer))}}]),t}(),m=function(){function t(e,i,a){r(this,t),this.buffer=void 0,this.inputSize=void 0,this.hiddenSize=void 0,this.outputSize=void 0,this.hiddenWeights=void 0,this.hiddenBiases=void 0,this.hiddenActivations=void 0,this.outputWeights=void 0,this.outputBiases=void 0,this.outputActivations=void 0,this.updatedHiddenWeights=void 0,this.updatedHiddenBiases=void 0,this.updatedOutputWeights=void 0,this.updatedOutputBiases=void 0;var n=i*e,u=i,s=i,o=a*i,h=a,d=a,l=new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o+h));this.buffer=l,this.inputSize=e,this.hiddenSize=i,this.outputSize=a,this.hiddenWeights=new Float64Array(l,0,n),this.hiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*n,u),this.hiddenActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u),s),this.outputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s),o),this.outputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o),h),this.outputActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h),d),this.updatedHiddenWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d),n),this.updatedHiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n),u),this.updatedOutputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u),o),this.updatedOutputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o),h),this.initializeWeights()}return n(t,null,[{key:"fromLayerSizes",value:function(e,i,r){return new t(e,i,r)}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[0],a=i[1],n=i[2],u=a*r,s=a,o=i.subarray(3,3+u),h=i.subarray(3+u,3+u+s),d=n*a,l=n,f=i.subarray(3+u+s,3+u+s+d),v=i.subarray(3+u+s+d,3+u+s+d+l),y=new t(r,a,n);return y.hiddenWeights.set(o),y.hiddenBiases.set(h),y.outputWeights.set(f),y.outputBiases.set(v),y}}]),n(t,[{key:"initializeWeights",value:function(){z(this.hiddenWeights,this.inputSize),z(this.outputWeights,this.hiddenSize)}},{key:"evaluate",value:function(t){for(var e,i=this.inputSize,r=this.hiddenSize,a=this.outputSize,n=this.hiddenWeights,u=this.hiddenBiases,s=this.hiddenActivations,o=this.outputWeights,h=this.outputBiases,d=this.outputActivations,l=0;l<r;l++){for(var f=0,v=0;v<i;v++)f+=n[l*i+v]*t[v];s[l]=(e=f+u[l],Math.max(0,e))}for(var y=0;y<a;y++){for(var p=0,g=0;g<r;g++)p+=o[y*r+g]*s[g];d[y]=_(p+h[y])}return d}},{key:"trainWithoutUpdating",value:function(t,e,i){for(var r=i.evaluationOptions,a=u(t,e,r),n=this.hiddenWeights,s=this.updatedHiddenWeights,o=this.hiddenBiases,h=this.updatedHiddenBiases,d=this.outputWeights,l=this.updatedOutputWeights,f=this.outputBiases,v=this.updatedOutputBiases,y=i.derivativeStep,p=i.learningRate,g=n.length,c=0;c<g;c++){var A=n[c];n[c]+=y;var E=(u(t,e,r)-a)/y;s[c]=A+E*p,n[c]=A}for(var B=o.length,w=0;w<B;w++){var S=o[w];o[w]+=y;var k=(u(t,e,r)-a)/y;h[w]=S+k*p,o[w]=S}for(var F=d.length,T=0;T<F;T++){var W=d[T];d[T]+=y;var m=(u(t,e,r)-a)/y;l[T]=W+m*p,d[T]=W}for(var z=f.length,_=0;_<z;_++){var M=f[_];f[_]+=y;var b=(u(t,e,r)-a)/y;v[_]=M+b*p,f[_]=M}}},{key:"update",value:function(){var t=this.hiddenWeights,e=this.updatedHiddenWeights,i=this.hiddenBiases,r=this.updatedHiddenBiases,a=this.outputWeights,n=this.updatedOutputWeights,u=this.outputBiases,s=this.updatedOutputBiases;t.set(e),i.set(r),a.set(n),u.set(s)}},{key:"toArrayBuffer",value:function(){var t=this.inputSize,e=this.hiddenSize,i=this.outputSize,r=this.hiddenWeights,a=this.hiddenBiases,n=this.outputWeights,u=this.outputBiases,s=new Float64Array(3+r.length+a.length+n.length+u.length);return s[0]=t,s[1]=e,s[2]=i,s.set(r,3),s.set(a,3+r.length),s.set(n,3+r.length+a.length),s.set(u,3+r.length+a.length+n.length),s.buffer}}]),t}();function z(t,e){for(var i=0;i<t.length;i++)t[i]=o(0,1/Math.sqrt(e))}function _(t){return 1/(1+Math.exp(-t))}var M=function(){function t(e,i){r(this,t),this.leaderNetwork=e,this.followerNetwork=i,this.agentType=void 0,this.inputs=void 0,this.agentType=L.Habanero,this.inputs=new Float64Array(3)}return n(t,[{key:"lead",value:function(t,e){var i=this.inputs;return i[0]=2*t-1,i[1]=2*e-1,this.leaderNetwork.evaluate(i)}},{key:"follow",value:function(t,e,i){var r=this.inputs;return r[0]=2*t-1,r[1]=2*e-1,r[2]=2*i-1,this.followerNetwork.evaluate(r)[0]}},{key:"train",value:function(t,e){var i=this.leaderNetwork,r=this.followerNetwork;i.trainWithoutUpdating(this,t,e),r.trainWithoutUpdating(this,t,e),i.update(),r.update()}},{key:"toArrayBuffer",value:function(){var t=new Float64Array(this.leaderNetwork.toArrayBuffer()),e=new Float64Array(this.followerNetwork.toArrayBuffer()),i=new Float64Array(3+t.length+e.length);return i[0]=this.agentType,i[1]=t.length,i[2]=e.length,i.set(t,3),i.set(e,3+t.length),i.buffer}}],[{key:"fromCreationOptions",value:function(e){return t.fromHiddenLayerSize(e.hiddenLayerSize)}},{key:"fromHiddenLayerSize",value:function(e){return new t(b.fromLayerSizes(2,e,2),b.fromLayerSizes(3,e,1))}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[1],a=i[2];return new t(b.fromArrayBuffer(i.slice(3,3+r).buffer),b.fromArrayBuffer(i.slice(3+r,3+r+a).buffer))}}]),t}(),b=function(){function t(e,i,a){r(this,t),this.buffer=void 0,this.inputSize=void 0,this.hiddenSize=void 0,this.outputSize=void 0,this.hiddenWeights=void 0,this.hiddenBiases=void 0,this.hiddenActivations=void 0,this.outputWeights=void 0,this.outputBiases=void 0,this.outputActivations=void 0,this.updatedHiddenWeights=void 0,this.updatedHiddenBiases=void 0,this.updatedOutputWeights=void 0,this.updatedOutputBiases=void 0;var n=i*e,u=i,s=i,o=a*i,h=a,d=a,l=new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o+h));this.buffer=l,this.inputSize=e,this.hiddenSize=i,this.outputSize=a,this.hiddenWeights=new Float64Array(l,0,n),this.hiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*n,u),this.hiddenActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u),s),this.outputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s),o),this.outputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o),h),this.outputActivations=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h),d),this.updatedHiddenWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d),n),this.updatedHiddenBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n),u),this.updatedOutputWeights=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u),o),this.updatedOutputBiases=new Float64Array(l,Float64Array.BYTES_PER_ELEMENT*(n+u+s+o+h+d+n+u+o),h),this.initializeWeights()}return n(t,null,[{key:"fromLayerSizes",value:function(e,i,r){return new t(e,i,r)}},{key:"fromArrayBuffer",value:function(e){var i=new Float64Array(e),r=i[0],a=i[1],n=i[2],u=a*r,s=a,o=i.subarray(3,3+u),h=i.subarray(3+u,3+u+s),d=n*a,l=n,f=i.subarray(3+u+s,3+u+s+d),v=i.subarray(3+u+s+d,3+u+s+d+l),y=new t(r,a,n);return y.hiddenWeights.set(o),y.hiddenBiases.set(h),y.outputWeights.set(f),y.outputBiases.set(v),y}}]),n(t,[{key:"initializeWeights",value:function(){N(this.hiddenWeights,this.inputSize),N(this.outputWeights,this.hiddenSize)}},{key:"evaluate",value:function(t){for(var e=this.inputSize,i=this.hiddenSize,r=this.outputSize,a=this.hiddenWeights,n=this.hiddenBiases,u=this.hiddenActivations,s=this.outputWeights,o=this.outputBiases,h=this.outputActivations,d=0;d<i;d++){for(var l=0,f=0;f<e;f++)l+=a[d*e+f]*t[f];u[d]=O(l+n[d])}for(var v=0;v<r;v++){for(var y=0,p=0;p<i;p++)y+=s[v*i+p]*u[p];h[v]=O(y+o[v])}return h}},{key:"trainWithoutUpdating",value:function(t,e,i){for(var r=i.evaluationOptions,a=u(t,e,r),n=this.hiddenWeights,s=this.updatedHiddenWeights,o=this.hiddenBiases,h=this.updatedHiddenBiases,d=this.outputWeights,l=this.updatedOutputWeights,f=this.outputBiases,v=this.updatedOutputBiases,y=i.derivativeStep,p=i.learningRate,g=n.length,c=0;c<g;c++){var A=n[c];n[c]+=y;var E=(u(t,e,r)-a)/y;s[c]=A+E*p,n[c]=A}for(var B=o.length,w=0;w<B;w++){var S=o[w];o[w]+=y;var k=(u(t,e,r)-a)/y;h[w]=S+k*p,o[w]=S}for(var F=d.length,T=0;T<F;T++){var W=d[T];d[T]+=y;var m=(u(t,e,r)-a)/y;l[T]=W+m*p,d[T]=W}for(var z=f.length,_=0;_<z;_++){var M=f[_];f[_]+=y;var b=(u(t,e,r)-a)/y;v[_]=M+b*p,f[_]=M}}},{key:"update",value:function(){var t=this.hiddenWeights,e=this.updatedHiddenWeights,i=this.hiddenBiases,r=this.updatedHiddenBiases,a=this.outputWeights,n=this.updatedOutputWeights,u=this.outputBiases,s=this.updatedOutputBiases;t.set(e),i.set(r),a.set(n),u.set(s)}},{key:"toArrayBuffer",value:function(){var t=this.inputSize,e=this.hiddenSize,i=this.outputSize,r=this.hiddenWeights,a=this.hiddenBiases,n=this.outputWeights,u=this.outputBiases,s=new Float64Array(3+r.length+a.length+n.length+u.length);return s[0]=t,s[1]=e,s[2]=i,s.set(r,3),s.set(a,3+r.length),s.set(n,3+r.length+a.length),s.set(u,3+r.length+a.length+n.length),s.buffer}}]),t}();function N(t,e){for(var i=0;i<t.length;i++)t[i]=o(0,1/Math.sqrt(e))}function O(t){return 1/(1+Math.exp(-t))}var L,P=function(){function t(e){r(this,t),this.minStrength=e,this.agentType=void 0,this.leadOutput=void 0,this.agentType=L.Ilama,this.leadOutput=new Float64Array(2)}return n(t,null,[{key:"fromCreationOptions",value:function(e){return new t(e.minStrength)}},{key:"fromArrayBuffer",value:function(e){return new t(new Float64Array(e)[1])}}]),n(t,[{key:"lead",value:function(t,e){var i=this.leadOutput;v(e,i);var r=t>=this.minStrength;return i[0]*=r,i[1]*=r,i}},{key:"follow",value:function(t,e,i){return i*(t>this.minStrength)}},{key:"train",value:function(){}},{key:"toArrayBuffer",value:function(){return new Float64Array([L.Ilama,this.minStrength]).buffer}}]),t}();!function(t){t[t.Artichoke=1]="Artichoke",t[t.Broccoli=2]="Broccoli",t[t.Carrot=3]="Carrot",t[t.Daikon=4]="Daikon",t[t.Eggplant=5]="Eggplant",t[t.Fig=6]="Fig",t[t.Grape=7]="Grape",t[t.Habanero=8]="Habanero",t[t.Ilama=9]="Ilama"}(L||(L={}));var R,H=[L.Artichoke,L.Broccoli,L.Carrot,L.Daikon,L.Eggplant,L.Fig,L.Grape,L.Habanero,L.Ilama];function Y(t){var e,i=new Float64Array(t)[0];if(e=i,H.includes(e))return function(t,e){switch(e){case L.Artichoke:return h.fromArrayBuffer(t);case L.Broccoli:return A.fromArrayBuffer(t);case L.Carrot:return E.fromArrayBuffer(t);case L.Daikon:return B.fromArrayBuffer(t);case L.Eggplant:return w.fromArrayBuffer(t);case L.Fig:return S.fromArrayBuffer(t);case L.Grape:return W.fromArrayBuffer(t);case L.Habanero:return M.fromArrayBuffer(t);case L.Ilama:return P.fromArrayBuffer(t)}}(t,i);throw new TypeError("Cannot recognize AgentType: "+i)}!function(t){t[t.Start=0]="Start",t[t.Done=1]="Done"}(R||(R={})),self.addEventListener("message",(function(t){var e=t.data;"object"===typeof e&&null!==e&&e.messageType===R.Start&&function(t){var e=Y(t.agentABuffer),i=Y(t.agentBBuffer),r=u(e,i,t.evaluationOptions);self.postMessage({messageType:R.Done,evaluation:r})}(e)}))}]);
//# sourceMappingURL=5dd6643fbf650d370444.worker.js.map